# UsagiHub 设计方案

---

## 一、项目概述

- **项目名称**：UsagiHub  
- **产品类型**：表情包与视频素材公开资源站  
- **目标用户**：泛二次元爱好者、创作者、表情包使用者  
- **核心价值**：
  - 极简无门槛访问：无需注册，直接搜索与下载  
  - 高效内容管理：通过后台进行素材上传、分类、打包  
  - 素材公开透明：聚焦非商业用途的轻量化分享  

---

## 二、技术架构概览

### 架构说明

- 前台页面使用 Next.js + React 实现内容展示；
- 后台管理系统基于 Next.js + Ant Design 构建；
- 所有接口通过 Next.js API Routes 提供；
- 数据使用 MySQL/SQLite 存储，静态资源走 OSS/CDN。

### 架构图

```

用户浏览器
│
├──▶ 前台页面（Next.js + React）
│       └──▶ 表情包 / 视频素材 / 搜索 / 下载
│
├──▶ 后台管理页面（/admin）
│       └──▶ 登录验证 + 素材上传 + 标签维护 + 合集管理
│
└──▶ API 路由（Next.js API Routes）
├──▶ 数据库（MySQL / SQLite + Prisma）
└──▶ 静态文件存储（本地或阿里云 OSS）

```

---

## 三、技术栈选型

| 模块         | 技术                             | 用途说明                          |
|--------------|----------------------------------|-----------------------------------|
| 前端框架     | React 18 + Next.js 14            | 全栈渲染，支持 SSR 和 API Routes  |
| UI 库        | Ant Design 5                     | 后台管理界面                      |
| 状态管理     | Zustand / Context API            | 登录状态、筛选条件等              |
| ORM & DB     | Prisma + MySQL / SQLite          | 素材元数据、标签信息              |
| 鉴权系统     | JWT + Cookie / NextAuth.js       | 登录与路由保护                    |
| 文件上传     | Multer / Formidable              | 上传图片 / 视频 / zip             |
| 图像处理     | Sharp                            | 缩略图、预览图生成                |
| 文件存储     | 阿里云 OSS / 本地存储            | 静态资源管理                      |
| 部署方式     | Vercel / Node.js + Nginx         | 小规模用 Vercel，大型用自建服务器 |

---

## 四、前台系统设计

### 页面结构

| 页面路径          | 功能描述                               |
|-------------------|----------------------------------------|
| `/`               | 首页，热门标签云 + 推荐素材            |
| `/emojis`         | 表情包列表页 + 筛选器 + 网格展示       |
| `/emojis/[id]`    | 表情包详情页 + 动态预览 + 下载按钮     |
| `/videos`         | 视频素材页 + 筛选器 + 封面 + 预览      |
| `/videos/[id]`    | 视频详情页 + 播放器 + 标签信息         |
| `/search`         | 搜索页，支持关键词与标签联动过滤       |
| `/packages/[slug]`| 合集页 + ZIP 下载 + 素材展示           |
| `/legal`          | 使用说明 / 非商业提示                  |
| `/404`            | 页面未找到                             |

### 功能特点

- 支持标签筛选（情绪 / 场景 / 格式）
- 支持关键词模糊搜索
- 所有内容一键下载（单张 / 合集）
- 兼容移动端浏览
- 下载前弹窗提示合规性

---

## 五、后台管理系统设计

### 页面结构

| 页面路径           | 功能描述                               |
|--------------------|----------------------------------------|
| `/admin/login`     | 管理员登录页                           |
| `/admin/dashboard` | 数据统计总览                           |
| `/admin/emojis`    | 表情包上传 / 编辑 / 删除               |
| `/admin/videos`    | 视频上传 / 分辨率管理 / 设置封面       |
| `/admin/packages`  | 合集创建 / 封面上传 / ZIP 下载         |
| `/admin/tags`      | 标签管理（新增 / 编辑 / 删除）         |
| `/admin/settings`  | 管理员信息修改 / 上传配置               |

### 功能模块

- 表情包与视频素材上传（批量 / 单独）
- 素材元信息管理（标题 / 标签 / 可见性）
- 标签系统维护（分类、使用频率）
- 素材状态控制（草稿 / 已发布 / 隐藏）
- 合集内容打包发布（ZIP）
- 素材统计与使用报表导出（CSV）

---

## 六、API 路由设计

| 路径                   | 方法   | 描述                           |
|------------------------|--------|--------------------------------|
| `/api/login`           | POST   | 管理员登录，返回 token         |
| `/api/emojis`          | GET    | 获取所有表情包元数据           |
| `/api/emojis`          | POST   | 上传表情包（支持 zip 批量）    |
| `/api/emojis/[id]`     | PUT    | 更新素材信息                   |
| `/api/emojis/[id]`     | DELETE | 删除表情包素材                 |
| `/api/videos`          | 同上   | 视频素材接口结构一致           |
| `/api/packages`        | POST   | 创建素材合集                   |
| `/api/tags`            | GET/POST/DELETE | 标签 CRUD 接口          |
| `/api/stats`           | GET    | 素材使用统计                   |

---

## 七、部署与运维

### 部署方式

#### Vercel 托管

- 自动构建 Next.js 应用
- 静态资源使用阿里云 OSS
- 数据库推荐 PlanetScale

#### 自建服务器

- Node.js + PM2 + Nginx
- 使用阿里云 / 腾讯云 OSS
- 使用本地 MySQL 或云数据库
- 支持日志分析与 IP 限流

### 安全建议

- 上传白名单：图片、视频、zip 格式校验
- 登录限频，支持验证码 / 强密码策略
- 后台路由保护 `/admin/*`
- 所有敏感接口记录操作日志

---

## 八、开发阶段建议

| 阶段     | 时间      | 内容                                 |
|----------|-----------|--------------------------------------|
| 第 1 阶段 | 第 1 周   | 初始化项目结构，构建登录系统         |
| 第 2 阶段 | 第 2-3 周 | 实现素材上传与预览功能               |
| 第 3 阶段 | 第 4 周   | 实现标签管理与筛选功能               |
| 第 4 阶段 | 第 5 周   | 实现合集打包下载与统计模块           |
| 第 5 阶段 | 第 6 周   | 上线部署，接入 CDN、OSS 加速         |

---

## 九、推荐工具

- **开发工具**：VS Code + ESLint + Prettier  
- **调试工具**：Postman / Thunder Client  
- **数据库管理**：Prisma Studio / MySQL Workbench  
- **存储服务**：阿里云 OSS / Cloudflare R2  
- **协作平台**：GitHub + Notion / 飞书文档

---

## 十、可选扩展功能

- 热门标签 / 搜索词自动联想  
- CDN 下载加速与并发保护  
- 管理员多角色支持（运营 / 编辑）  
- AI 自动标注标签（使用图像模型）  
- 小程序端 / 手机适配页面优化  

---
